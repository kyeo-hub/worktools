# WorkTools v1.2.0 发布说明

## 发布日期
2025-12-11

## 版本信息
- 版本号: v1.2.0
- 版本类型: 功能更新

## 主要更新

### 1. 插件管理系统完善
- ✅ 实现插件文件名与插件 ID 完全对应
- ✅ 修正所有插件文件命名：
  - `plugin1.py` → `text_processor.py`
  - `plugin2.py` → `file_manager.py`
  - `plugin3.py` → `system_tools.py`

### 2. 插件管理器 UI 优化
- ✅ 增加插件描述列，更直观展示插件功能
- ✅ 优化表格布局：
  - 名称列：根据内容自适应
  - 描述列：自动填充剩余空间
  - 操作列：固定宽度 140px
- ✅ 增加表格行高到 45px
- ✅ 优化按钮样式：
  - 最小宽度 90px
  - 最小高度 32px
  - 字体大小 13px，加粗
  - 内边距 6px 16px
- ✅ 改善文字显示，操作按钮更清晰

### 3. 插件依赖自动安装
- ✅ 检测缺失的插件依赖
- ✅ 自动调用 pip 安装依赖库
- ✅ 显示依赖安装进度
- ✅ 安装失败时提供明确提示

### 4. 插件打包系统
- ✅ 创建插件打包工具 `build_plugins.py`
- ✅ 将所有插件打包为独立 `.zip` 文件
- ✅ 生成插件仓库配置文件 `plugins.json`
- ✅ 每个插件包包含：
  - 插件 Python 文件
  - 版本信息
  - 依赖列表
  - 文件大小

### 5. 插件管理操作优化
- ✅ 改为页内操作，不再使用弹窗
- ✅ 添加操作面板显示进度和结果：
  - 操作标题
  - 进度条（0% → 100%）
  - 详细信息
  - 成功/失败状态
  - 重启提示
- ✅ 添加关闭按钮隐藏操作面板

### 6. 插件卸载功能修复
- ✅ 修正插件文件查找逻辑
- ✅ 建立插件 ID 到文件名的正确映射
- ✅ 修正系统工具卸载失败问题
- ✅ 完善卸载进度显示：
  - 30%: 查找文件
  - 70%: 删除文件
  - 100%: 完成
- ✅ 支持文件被占用时的标记删除

### 7. 插件包列表

| 插件 ID | 插件名称 | 文件大小 | 依赖 |
|---------|---------|---------|------|
| `text_processor` | 文本处理工具 | 3.5 KB | 无 |
| `file_manager` | 文件管理器 | 6.5 KB | 无 |
| `system_tools` | 系统工具 | 6.6 KB | 无 |
| `monthly_summary` | 月汇总工具 | 5.6 KB | pandas, openpyxl |
| `excel_merger` | Excel合并工具 | 6.8 KB | pandas, openpyxl |
| `excel_deduplication` | Excel去重工具 | 5.1 KB | pandas, openpyxl |
| `image_watermark` | 图片水印工具 | 11.4 KB | Pillow>=9.0.0 |

**总计**: 45.45 KB

## 文档更新

### 新增文档
- ✅ `docs/DEPLOY_PLUGINS.md` - 插件部署指南
- ✅ `docs/PLUGIN_MANAGER_GUIDE.md` - 插件管理器使用指南
- ✅ `docs/DESIGN_SPEC.md` - 详细设计规范
- ✅ `docs/plugins.json.example` - 插件仓库配置示例

### 更新文档
- ✅ `README.md` - 更新版本历史和功能说明
- ✅ `version.json` - 更新到 v1.2.0

## 工具脚本

### 新增脚本
- ✅ `build_plugins.py` - 插件打包工具
- ✅ `deploy_plugins.py` - 插件包发布工具
- ✅ `compare_package_size.py` - 包大小对比工具

## 技术改进

### 代码优化
- 简化插件加载逻辑，移除复杂的文件映射
- 统一插件 ID 使用规范
- 优化表格渲染性能
- 完善错误处理和日志记录

### 用户体验
- 操作流程更清晰，实时反馈进度
- 依赖安装自动化，减少用户手动操作
- 按钮显示更大，点击更容易
- 错误提示更详细，问题定位更快

## 测试覆盖

### 功能测试
- ✅ 插件列表加载和显示
- ✅ 插件搜索和分类筛选
- ✅ 插件安装流程（含依赖）
- ✅ 插件卸载流程
- ✅ 插件文件名匹配
- ✅ 操作面板显示和关闭

### 兼容性测试
- ✅ Windows 环境测试
- ✅ Python 3.11 测试
- ✅ PyQt5 测试
- ✅ 本地 file:// 协议测试

## 已知问题
无

## 升级说明

### 从 v1.1.0 升级
1. 备份现有配置
2. 下载新版本安装包
3. 解压覆盖旧版本
4. 启动应用程序
5. 插件会自动加载

### 插件迁移
- 已安装插件无需重新安装
- 插件文件名会自动映射
- 建议重启应用生效

## 下一步计划

### v1.3.0 计划
- [ ] 插件版本检查和更新提示
- [ ] 插件评分和评论系统
- [ ] 插件搜索增强（模糊匹配）
- [ ] 插件依赖冲突检测
- [ ] 批量安装/卸载功能

## 下载地址

- **应用下载**: https://tools.kyeo.top/updates/
- **插件仓库**: https://tools.kyeo.top/plugins/
- **更新检查**: https://tools.kyeo.top/updates/version.json

## 感谢
感谢所有用户的反馈和建议！

## 技术支持
如有问题，请通过以下方式联系：
- GitHub Issues: https://github.com/your-repo/issues
- 邮件: support@example.com

---
**WorkTools Team**
2025-12-11
